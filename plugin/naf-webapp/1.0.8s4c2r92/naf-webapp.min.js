// Copyright 1999-2012 SeaChange International
// All Rights Reserved.
NAF.conf={debug:2,traxisip:"217.249.130.196",traxisid:"device1",chanlocsrc:"traxis",traxisidprefix:"CpeId",traxisUrl:"",numhours:4,refreshInterval:10,refreshInterval0:1,reminderTime:5,fetchInitEventsInChunks:!0,eventsRefreshInChunks:20,eventsRefreshTimeout:1E3,pretune:!0,previouspretunes:0,followingpretunes:1,searchCacheSize:10,upcPrice:!1,maxPinAttempts:3,pinRetryInterval:300,wakeuptime:120,prerecordwakeuptime:3,teletextHandling:!1,langTimeOut:500,mediawareip:"",chanUpDownKeyHandling:!1,startChannel:"CNN",
initChannel:"lastViewed",lockedChannels:[],profileAgeRating:0,enable000reload:!1,canned:!1,cannedPath:"../data/217.149.130.199",useNewRecordingManager:!0,useUnifiedMapPlayer:!0,catchUpCategory:"crid:~~2F~~2Fschange.com~~2F4e3c5465-a7dc-4e7b-b94e-fd2b9eb6e500",catchUpChannel:0,genreData:JSON.stringify({genres:[{code:"1",name:"movie",subgenres:[]},{code:"2",name:"news",subgenres:[]},{code:"3",name:"show",subgenres:[]},{code:"4",name:"sports",subgenres:[]},{code:"5",name:"children's",subgenres:[]},{code:"6",
name:"music",subgenres:[]},{code:"7",name:"arts",subgenres:[]},{code:"8",name:"social",subgenres:[]},{code:"9",name:"education",subgenres:[]},{code:"10",name:"leisure",subgenres:[]},{code:"11",name:"special",subgenres:[]},{code:"12",name:"entertainment",subgenres:[]},{code:"13",name:"crime",subgenres:[]},{code:"14",name:"series",subgenres:[]},{code:"15",name:"adult",subgenres:[]}]}),provideDefaultSettings:!0,applications:[{id:"id1",name:"MetrologicalAppStore",shortSynopsis:"The Metrological App Store",
isAdult:!1,isViewable:!0,isEntitled:!0,url:"http://widgets.metrological.com/dawn/be/development/?debug=2",type:"store"}]};
function nafCleanupConf(){NAF.conf.canned&&(NAF.conf.traxisid="");if("undefined"!==typeof window){for(var d=[],h,k=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),f=0;f<k.length;f++)h=k[f].split("="),d.push(h[0]),d[h[0]]=h[1];for(f=0;f<d.length;f++)NAF.conf.hasOwnProperty(d[f])&&(h=d[d[f]],isNaN(h)?NAF.conf[d[f]]="true"===h?!0:"false"===h?!1:h:NAF.conf[d[f]]=parseFloat(h,10))}}nafCleanupConf();nafCleanupConf=null;
NAF.utils={convertJSONDateToJSDate:function(d){var h;return"string"===typeof d&&(h=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(d))?new Date(Date.UTC(+h[1],+h[2]-1,+h[3],+h[4],+h[5],+h[6])):h},convertLocalJSONDateToLocalJSDate:function(d){var h;return"string"===typeof d&&(h=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(d))?new Date(+h[1],+h[2]-1,+h[3],+h[4],+h[5],+h[6]):h},convertJSONDateToMins:function(d){d=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(d);
return(new Date(Date.UTC(+d[1],+d[2]-1,+d[3],+d[4],+d[5],+d[6]))).getTime()/6E4},convertJSONDateToJSDateCanned:function(d){var h,k=new Date;return"string"===typeof d&&(h=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(d))?new Date(Date.UTC(+k.getUTCFullYear(),+k.getUTCMonth(),+k.getUTCDate(),+h[4],+h[5],+h[6])):h},convertJSDateToJSONDate:function(d){var h=d.getUTCMonth()+1;10>h&&(h="0"+h);var k=d.getUTCDate();10>k&&(k="0"+k);var f=d.getUTCHours();10>f&&(f="0"+f);var c=d.getUTCMinutes();
10>c&&(c="0"+c);return d.getUTCFullYear()+"-"+h+"-"+k+"T"+f+":"+c+":00Z"},clearTimer:function(d){d&&clearTimeout(d)},encodeXML:function(d){return d.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},throttle:function(d,h){function k(){f=null}var f,c,m;return function(){c=this;m=arguments;f||(result=d.apply(c,m),f=setTimeout(k,h))}},decimalToBinary:function(d,h){for(var k=
d,f=0,c=[];0<k;)f=k%2,k=Math.floor(k/2),c.unshift(f);k=h-c.length;if(0<k)for(f=0;f<k;f++)c.unshift(0);else if(0>k)return null;return c},Log:function(){function d(a,b){if(h&&a.rank<=r.rank){console.log((new Date).toISOString()+" "+a.text+" "+k+" "+b[0]);for(var g=1;g<b.length;g++)console.log(b[g])}}var h=!1,k="",f={text:" FATAL ",rank:0},c={text:" ERROR ",rank:1},m={text:" WARN  ",rank:2},e={text:" DEBUG ",rank:3},p={text:" TRACE ",rank:4},q={text:" INFO  ",rank:5},r=p;this.trace=function(){d(p,arguments)};
this.debug=function(){d(e,arguments)};this.info=function(){d(q,arguments)};this.warn=function(){d(m,arguments)};this.error=function(){d(c,arguments)};this.fatal=function(){d(f,arguments)};this.enable=function(){h=!0};this.disable=function(){h=!1};this.setAppName=function(a){k=a};this.setLevel=function(){return{fatal:function(){r=f},error:function(){r=c},warn:function(){r=m},debug:function(){r=e},trace:function(){r=p},info:function(){r=q}}}();this.getCurrLevel=function(){return r.rank}}};
NAF.Map=function(d,h){function k(){var a=new XMLHttpRequest,b={};b.method=arguments[0];b.id=e++;b.jsonrpc=p;for(var g={},f=1;f<arguments.length;f+=2)g[arguments[f]]=arguments[f+1];b.params=g;b=JSON.stringify(b);g="/ajax?"+encodeURI(b);"undefined"!=typeof m&&""!=m&&(g="http://"+m+g);c.debug("MAP-REQ: "+b);a.open("GET",g,!1);a.setRequestHeader("Content-Type","application/json;charset=UTF-8");a.send(null);var l;try{l=JSON.parse(a.responseText)}catch(d){l={error:d,result:-1}}l.error?c.error("MAP-ERR: code="+
l.error.code+" message="+l.error.message):c.debug("MAP-RES: status="+a.status+" response="+a.responseText.substr(0,80));return l.result}function f(a,b,g){var f=b.callbackParams;delete b.callbackParams;var l=new XMLHttpRequest,d={};d.method=a;d.id=e++;d.jsonrpc=p;b&&"{}"!=JSON.stringify(b)&&(d.params=b);a=JSON.stringify(d);b="/ajax?"+encodeURI(a);"undefined"!=typeof m&&""!=m&&(b="http://"+m+b);c.debug("MAP-ASYNC-REQ: "+a);l.open("GET",b,!0);l.setRequestHeader("Content-Type","application/json;charset=UTF-8");
l.onreadystatechange=function(){if(4===l.readyState){var a;try{200==l.status?3>=c.getCurrLevel()?c.debug("MAP-ASYNC-RESPONSE: SUCCESS "+l.responseText.substr(0,200)):c.debug("MAP-ASYNC-RESPONSE: SUCCESS "+l.responseText):c.debug("MAP-ASYNC-RESPONSE: ERROR "+l.responseText),a=JSON.parse(l.responseText)}catch(b){a={error:b,result:-1}}a.error&&c.error("MAP-ERR: code="+a.error.code+" message="+a.error.message);g&&g(a.result,f);l=f=l.onreadystatechange=null}};l.send(null);b=a=d=null}var c=d.log,m=h,e=
1,p="2.0",q,r=this;c.warn("***DEPRECATED key map in NAF.Map, moving to NAF.Model.KeyMap****\n");this.VK_EXIT=3;this.VK_BACK_SPACE=8;this.VK_ENTER=this.VK_OK=13;this.VK_KEYBOARD=16;this.VK_ACCEPT=30;this.VK_SPACE=32;this.VK_PAGE_UP=33;this.VK_PAGE_DOWN=34;this.VK_HOME=36;this.VK_LEFT=37;this.VK_UP=38;this.VK_RIGHT=39;this.VK_DOWN=40;this.VK_0=48;this.VK_1=49;this.VK_2=50;this.VK_3=51;this.VK_4=52;this.VK_5=53;this.VK_6=54;this.VK_7=55;this.VK_8=56;this.VK_9=57;this.VK_A=65;this.VK_B=66;this.VK_C=67;
this.VK_D=68;this.VK_E=69;this.VK_F=70;this.VK_G=71;this.VK_H=72;this.VK_I=73;this.VK_J=74;this.VK_K=75;this.VK_L=76;this.VK_M=77;this.VK_N=78;this.VK_O=79;this.VK_P=80;this.VK_Q=81;this.VK_R=82;this.VK_S=83;this.VK_T=84;this.VK_U=85;this.VK_V=86;this.VK_W=87;this.VK_X=88;this.VK_Y=89;this.VK_Z=90;this.VK_RED=403;this.VK_GREEN=404;this.VK_BLUE=406;this.VK_YELLOW=405;this.VK_DELETE=127;this.VK_HELP=156;this.VK_POWER=409;this.VK_CHANNEL_UP=427;this.VK_CHANNEL_DOWN=428;this.VK_VOLUME_UP=447;this.VK_VOLUME_DOWN=
448;this.VK_MUTE=449;this.VK_INFO=457;this.VK_GUIDE=458;this.VK_BACK=461;this.VK_MENU=462;this.VK_PAUSE=19;this.VK_REW=412;this.VK_STOP=413;this.VK_PLAY=415;this.VK_REC=416;this.VK_FF=417;this.VK_REW_SKIP=424;this.VK_FWD_SKIP=425;this.VK_FAV=433;this.VK_TELETEXT=459;this.VK_SUBTITLE=460;this.SetAsyncEventHandlers=function(a,b,g){q=new EventSource("/server-sent-events");q.onopen=a;q.onmessage=function(a){a:{var f;try{f=JSON.parse(a.data)}catch(e){c.error("server-sent event parsing failed, event handler not invoked."+
e);g("Invalid server-sent event");break a}"undefined"!==typeof f.method?b(f):(c.error("server-sent event is not a valid MW event, event handler not invoked."),g("Invalid server-sent event"))}};q.onerror=function(f){var c;switch(f.target.readyState){case EventSource.CONNECTING:c="Eventsource reconnecting.";break;case EventSource.CLOSED:c="Eventsource closed. Creating a new one.",setTimeout(function(){r.SetAsyncEventHandlers(a,b,g)},1E4)}g(c)}};this.VidSetAnimationParameters=function(a,b,g,c,l,e){f("VidSetAnimationParameters",
{windowId:a,bAnimate:b,duration:g,speed:speed,fps:l},e)};this.VidPretune=function(a,b,g){f("VidPreTune",{windowId:a,LocatorArray:b},g)};this.VidStopPretune=function(a,b,g){f("VidStopPreTune",{windowId:a},g)};this.VidGetCurChan=function(a){f("VidGetCurChan",{},a)};this.VidGetLastChan=function(a){f("VidGetLastChan",{},a)};this.VidGetStartChan=function(){return null};this.VidDetune=function(a){f("VidDetune",{},a)};this.VidGetChanCount=function(a){f("VidGetChanCount",{},a)};this.VidGetChannelList=function(a,
b){f("VidGetChannelList",{platform:a},b)};this.VidSetVideoWinSize=function(a,b,g,c,l,e){f("VidSetVideoWinSize",{x:a,y:b,w:g,h:c,bPIP:l},e)};this.VidEnableCC=function(a,b){f("VidSetCloseCap",{enable:a},b)};this.VidGetAvailableAudioLang=function(a){f("GetAvailableAudioLanguages",{},a)};this.VidSetPrefAudioLang=function(a,b,g,c){var l={};l.language=a;l.type=b;l.callbackParams=c;f("SetAudioLanguagePreference",l,g)};this.VidGetPrefAudioLang=function(a){f("GetAudioLanguagePreference",{},a)};this.VidSetAudioLang=
function(a,b,g){var c={};c.language=a;c.callbackParams=g;f("SetAudioLanguage",c,b)};this.VidGetAudioLang=function(a){f("GetAudioLanguage",{},a)};this.VidSetResolution=function(a,b,g){f("VidSetResolution",{port:a,resolution:b},g)};this.VidStopPIP=function(a){f("VidStopPIP",{},a)};this.VidMakePipPrimary=function(a){f("VidMakePipPrimary",{},a)};this.VidGetAvailableSubtitleLang=function(a){f("GetAvailableSubtitleLanguages",{},a)};this.VidSetPrefSubtitleLang=function(a,b,g,c){var l={};l.language=a;l.type=
b;l.callbackParams=c;f("SetSubtitleLanguagePreference",l,g)};this.VidGetPrefSubtitleLang=function(a){f("GetSubtitleLanguagePreference",{},a)};this.VidGetSubtitleAvailability=function(a){f("GetSubtitleAvailability",{},a)};this.VidEnableSubtitle=function(a,b){var g={};g.enable=a;f("EnableSubtitle",g,b)};this.VidSetSubtitleLang=function(a,b,g){var c={};c.language=a;c.callbackParams=g;f("SetSubtitleLanguage",c,b)};this.VidGetSubtitleLang=function(a){f("GetSubtitleLanguage",{},a)};this.IsSubtitleEnabled=
function(a){f("IsSubtitleEnabled",{},a)};this.VidSetPrefTeletextLang=function(a,b){return k("SetTeletextLanguage","language",a,"type",b)};this.VidGetPrefTeletextLang=function(){};this.IsTeletextEnabled=function(a){f("IsTeletextEnabled",{},a)};this.EnableTeletext=function(a,b){f("EnableTeletext",{enable:a},b)};this.IsTeletextAvailable=function(a){f("IsTeletextAvailable",{},a)};this.VidSetTeletextLang=function(a,b){};this.VidGetTeletextLang=function(){};this.VidSpeakerMute=function(a,b){f("VidSpeakerMute",
{flag:a},b)};this.VidDisplayVideoOn=function(a,b){f("VidDisplayVideoOn",{flag:a},b)};this.DlnaSetDeviceName=function(a,b){return k("MapDLNASetDeviceName","name",a,"type",b)};this.DlnaGetDeviceName=function(a){return k("MapDLNAGetDeviceName","type",a)};this.MapDLNAGetActiveDevices=function(a){return k("MapDLNAGetActiveDevices","type",a)};this.MapDLNAGetContainer=function(a,b,g,c,l,e,d,n){if(n)f("MapDLNAGetContainer",{id:a,containerId:b,containerType:g,filter:c,startAt:l,requestedCount:e,sort:d},n);
else return k("MapDLNAGetContainer","id",a,"containerId",b,"containerType",g,"filter",c,"startAt",l,"requestedCount",e,"sort",d)};this.MapPlayer=function(a,b,g,c,l,e,d,n,t,m,p){var k={};k.type=l;k.x=e;k.y=d;k.width=n;k.height=t;l={};p&&(l.callbackParams=p);l.ver="1.0";l.url=a;l.block=b;l.rate=g;l.playPos=c;l.window=k;f("MapPlayer",l,m)};this.MapPlayerRTSPVod=function(a,b,g,c,l,e,d,n,t,m){var p={};p.type=l;p.x=e;p.y=d;p.width=n;p.height=t;l={ver:"1.0"};l.id=a;l.block=b;l.rate=g;l.playPos=c;l.window=
p;f("MapPlayer",l,m)};this.MapPlayerStop=function(a,b,g,c,l,e){var d={};d.type=a;d.x=b;d.y=g;d.width=c;d.height=l;f("MapPlayer",{ver:"1.0",window:d},e)};this.MapPlayerSkip=function(a,b,g,c,l,e,d,n,t){var m={};m.type=c;m.x=l;m.y=e;m.width=d;m.height=n;f("MapPlayer",{ver:"1.0",url:a,rate:b,playPos:g,window:m},t)};this.DvrSync=function(){return k("PvrSync")};this.DvrRecord=function(a,b,g,c,e,d,m,n){var t;if(0!=m){t=d?new Date(1E3*d):new Date;for(var p="",k=0;k<m.length;k++)p=7==m[k]?"0,"+p:p+(m[k]+",");
p=p.substring(0,p.length-1);t=t.getMinutes()+" "+t.getHours()+" * * "+p}f("PvrSchedRecording",{locator:a,channelId:b,duration:g,title:c,description:e,start:d,interval:t},n)};this.DvrRecordEvent=function(a){console.log("DvrRecordEvent: "+a);return k("PvrSchedRecording","eventCrid",a)};this.DvrRecordSeries=function(a){console.log("DvrRecordSeries: "+a);return k("PvrSchedRecording","seriesCrid",a)};this.DvrUpdateRecord=function(a,b,g){if(void 0!=b&&void 0!=g)return k("PvrUpdateRecording","recordingId",
a,"duration",b,"start",g);if(void 0!=g)return console.log("DvrUpdateRecord(): duration is null!!!"),k("PvrUpdateRecording","recordingId",a,"start",g);if(void 0!=b)return console.log("DvrUpdateRecord(): startTime is null!!!"),k("PvrUpdateRecording","recordingId",a,"duration",b)};this.DvrAssetList=function(a){f("PvrListRecording",{},a)};this.DvrListRequests=function(a){if(a)f("PvrListRequests",{},a);else return k("PvrListRequests")};this.DvrListOperations=function(a){if(a)f("PvrListOperations",{},a);
else return k("PvrListOperations")};this.DvrListRecordings=function(a){if(a)f("PvrListRecordings",{},a);else return k("PvrListRecordings")};this.DvrPause=function(a){f("PvrPlayTrick",{speed:0},a)};this.DvrResume=function(a){f("PvrPlayTrick",{speed:100},a)};this.DvrFastForward=function(a,b){f("PvrPlayTrick",{speed:a},b)};this.DvrRewind=function(a,b){f("PvrPlayTrick",{speed:-a},b)};this.DvrOffset=function(a,b){f("PvrPlaySkip",{offset:a},b)};this.DvrDelete=function(a,b){f("PvrDeleteRecording",{locator:a},
b)};this.DvrDeleteRequest=function(a,b){f("PvrDelete",{requestId:a},b)};this.DvrDeleteOperation=function(a,b){f("PvrDelete",{operationId:a},b)};this.DvrDeleteRecording=function(a,b){f("PvrDelete",{recordingId:a},b)};this.DvrDeleteProtectOperation=function(a,b,g,c){var e={},e={operationId:a,protect:b};e.callbackParams=c;f("PvrDeleteProtect",e,g)};this.DvrPinProtectOperation=function(a,b,g,c){var e={},e={operationId:a,protect:b};e.callbackParams=c;f("PvrPinProtect",e,g)};this.DvrDeleteProtectRequest=
function(a,b,g,c){var e={},e={requestId:a,protect:b};e.callbackParams=c;f("PvrDeleteProtect",e,g)};this.DvrPinProtectRequest=function(a,b,g,c){var e={},e={requestId:a,protect:b};e.callbackParams=c;f("PvrPinProtect",e,g)};this.DvrStop=function(a){f("DvrStop",{},a)};this.PvrStop=function(a){f("PvrStop",{},a)};this.DvrStopRecording=function(a,b){f("PvrStopRecording",{recordingId:a},b)};this.VodSessionOpen=function(a,b,g){f("VodSessionOpen",{assetId:a,vodType:b},g)};this.VodSessionClose=function(a){f("VodSessionClose",
{},a)};this.VodPlay=function(a,b,g){f("VodPlay",{blocked:a,start:b},g)};this.VodPause=function(a){f("VodPause",{},a)};this.VodFastforward=function(a,b,g){f("VodFastforward",{numerator:a,denominator:b},g)};this.VodRewind=function(a,b,g){f("VodRewind",{numerator:a,denominator:b},g)};this.VodStop=function(a){f("VodStop",{},a)};this.VodGet=function(a,b){f("VodGet",{name:a},b)};this.VodSet=function(a,b,g){f("VodSet",{name:a,value:b},g)};this.VodPlaySkip=function(a,b){f("VodPlaySkip",{offset:a},b)};this.VodResume=
function(a){f("VodFastforward",{numerator:1,denominator:1},a)};this.ConfigGet=function(a,b){f("ConfigGet",{name:a},b)};this.ConfigSet=function(a,b){return k("ConfigSet","name",a,"value",b)};this.GetMWConfig=function(a,b,g){f("GetMWConfig",{section:a,key:b},g)};this.EmulateRemoteKey=function(a){return k("EmulateRemoteKey","KeyCode",a)};this.VerifyPin=function(a,b,g,c,e){var d={},d={profile:a,type:b,pin:g};d.callbackParams=e;f("VerifyPin",d,c)};this.ResetPin=function(a,b,g,c,e,d){var m={},m={profile:a,
type:b,masterpin:g,newpin:c};m.callbackParams=d;f("ResetPin",m,e)};this.GetPinState=function(a,b){f("GetPinState",{profile:a,type:b},callback)};this.ActivatePin=function(a,b,g,c){f("ActivatePin",{profile:a,type:b,masterpin:masterpin,activate:c},callback)};this.GetProfileNames=function(a,b){a()};this.ProfileSetInitChan=function(a,b,g,c){var e={};c&&(e.callbackParams=c);e.profileId=a;-1!=a.indexOf("MasterProfile")&&(e.keyword="master");e.Settings={};e.Settings.initChannel=b;f("WriteProfile",e,g)};this.ProfileGetInitChan=
function(a,b,g){var c={};g&&(c.callbackParams=g);c.profileId=a;c.Settings=["initChannel"];f("ReadProfile",c,b)};this.ProfileSetAgeRating=function(a,b,c,e){b=b?b:1001;var d={};e&&(d.callbackParams=e);d.profileId=a;-1!=a.indexOf("MasterProfile")&&(d.keyword="master");d.Settings={};d.Settings.ageRating=b;f("WriteProfile",d,c)};this.ProfileGetAgeRating=function(a,b,c){var e={};c&&(e.callbackParams=c);e.profileId=a;e.Settings=["ageRating"];f("ReadProfile",e,b)};this.ProfileSetStartupProtection=function(a,
b,c,e){var d={};e&&(d.callbackParams=e);d.profileId=a;-1!=a.indexOf("MasterProfile")&&(d.keyword="master");d.Settings={};d.Settings.startupProtection=b;f("WriteProfile",d,c)};this.SetStandbyMode=function(a,b,c,e){f("SetStandbyMode",{mode:a,time:b,callbackParams:e},c)};this.AcknowledgePowerManagerEvent=function(a){f("AcknowledgePowerManagerEvent",{},a)};this.PesGetAllEvents=function(a,b){f("GetAllEvents",{filter:a},b)};this.PesGetChannelsWithEvent=function(a,b,c,e){f("GetChannelsWithEvent",{ChanFilter:a,
ChanProps:b,EventFilter:c},e)};this.PesGetEventsByChanId=function(a,b){return k("GetEventsByChanId","chanId",a,"filter",b)};this.PesGetEventsByLcn=function(a,b){return k("GetEventsByLcn","lcn",a,"filter",b)};this.PesGetPfEventsByChanId=function(a){return k("GetPfEventsByChanId","chanId",a)};this.PesGetPfEventsByLcn=function(a){return k("GetPfEventsByLcn","lcn",a)};this.MapGetOnlineMode=function(a){f("MapGetOnlineMode",{},a)};this.writePVRProfile=function(a,b,c,e){var d={};d.callbackParams=e;d.profileId=
a;-1!=a.indexOf("MasterProfile")&&(d.keyword="master");d.Settings={};d.Settings.pvrSettings={};d.Settings.pvrSettings.frontPad=void 0!=b.newFrontPad?b.newFrontPad:b.frontPad;d.Settings.pvrSettings.backPad=void 0!=b.newBackPad?b.newBackPad:b.backPad;d.Settings.pvrSettings.seriesDomain=void 0!=b.newSeriesDomain?b.newSeriesDomain:b.seriesDomain;d.Settings.pvrSettings.diskManagement=void 0!=b.newDiskManagement?b.newDiskManagement:b.diskManagement;f("WriteProfile",d,c)};this.readPVRProfile=function(a,
b,c){var e={};c&&(e.callbackParams=c);e.profileId=a;-1!=a.indexOf("MasterProfile")&&(e.keyword="master");e.Settings=["pvrSettings"];f("ReadProfile",e,b)};this.writeViewSettingsProfile=function(a,b,c,e,d){var m={};m.callbackParams=d;m.profileId=a;-1!=a.indexOf("MasterProfile")&&(m.keyword="master");m.Settings={};m.Settings.viewSettings={};m.Settings.viewSettings.lang=void 0!=b.newCode?b.newCode:b.code;m.Settings.viewSettings.langType=void 0!=b.newType?b.newType:b.type;m.Settings.viewSettings.transparency=
void 0!=c.newTransparency?c.newTransparency:c.transparency;m.Settings.viewSettings.bannerTimeout=void 0!=c.newBannerTimeout?c.newBannerTimeout:c.bannerTimeout;m.Settings.viewSettings.epgStyle=void 0!=c.newEpgStyle?c.newEpgStyle:c.epgStyle;m.Settings.viewSettings.epgSpan=void 0!=c.newEpgSpan?c.newEpgSpan:c.epgSpan;m.Settings.viewSettings.assetsStyle=void 0!=c.newAssetsStyle?c.newAssetsStyle:c.assetsStyle;m.Settings.viewSettings.settingsProtection=void 0!=c.newSettingsProtection?c.newSettingsProtection:
c.settingsProtection;f("WriteProfile",m,e)};this.readViewSettingsProfile=function(a,b,c){var e={};c&&(e.callbackParams=c);e.profileId=a;-1!=a.indexOf("MasterProfile")&&(e.keyword="master");e.Settings=["viewSettings"];f("ReadProfile",e,b)};this.writeOutputSettingsProfile=function(a,b,c,e){var d={};d.callbackParams=e;d.profileId=a;-1!=a.indexOf("MasterProfile")&&(d.keyword="master");d.Settings={};d.Settings.outputSettings={};d.Settings.outputSettings.primary=void 0!=b.newPrimary?b.newPrimary:b.primary;
d.Settings.outputSettings.hdmiResolution=void 0!=b.hdmi.newResolution?b.hdmi.newResolution:b.hdmi.resolution;d.Settings.outputSettings.hdmiFormat=void 0!=b.hdmi.newFormat?b.hdmi.newFormat:b.hdmi.format;d.Settings.outputSettings.hdmiColor=void 0!=b.hdmi.newColor?b.hdmi.newColor:b.hdmi.color;d.Settings.outputSettings.hdmiAudioEnable=void 0!=b.hdmi.audio.newEnable?b.hdmi.audio.newEnable:b.hdmi.audio.enable;d.Settings.outputSettings.hdmiAudioDelay=void 0!=b.hdmi.audio.newDelay?b.hdmi.audio.newDelay:b.hdmi.audio.delay;
d.Settings.outputSettings.spdifEnable=void 0!=b.spdif.newEnable?b.spdif.newEnable:b.spdif.enable;d.Settings.outputSettings.spdifDelay=void 0!=b.spdif.newDelay?b.spdif.newDelay:b.spdif.delay;d.Settings.outputSettings.tvAspectRatio=void 0!=b.tv.newAspectRatio?b.tv.newAspectRatio:b.tv.aspectRatio;d.Settings.outputSettings.tvStart=void 0!=b.tv.newStart?b.tv.newStart:b.tv.start;d.Settings.outputSettings.scartFormat=void 0!=b.scart.newFormat?b.scart.newFormat:b.scart.format;d.Settings.outputSettings.scartColor=
void 0!=b.scart.newColor?b.scart.newColor:b.scart.color;d.Settings.outputSettings.scartEnable=void 0!=b.scart.newEnable?b.scart.newEnable:b.scart.enable;d.Settings.outputSettings.audioFormat=void 0!=b.audio.newFormat?b.audio.newFormat:b.audio.format;d.Settings.outputSettings.fpLuminosity=void 0!=b.frontPanel.newLuminosity?b.frontPanel.newLuminosity:b.frontPanel.luminosity;f("WriteProfile",d,c)};this.readOutputSettingsProfile=function(a,b,c){var e={};c&&(e.callbackParams=c);e.profileId=a;-1!=a.indexOf("MasterProfile")&&
(e.keyword="master");e.Settings=["outputSettings"];f("ReadProfile",e,b)};this.VidGetTSBInfo=function(a){f("GetTSBInfo",{},a)};this.VidGetTSBEventInfo=function(a){f("GetTSBEventInfo",{},a)};this.SubscribePlayerPosition=function(a,b){f("MAPSubscribeEvent",{name:"MWPlayerPosition",frequency:a},b)};this.UnsubscribePlayerPosition=function(a){f("MAPUnsubscribeEvent",{name:"MWPlayerPosition"},a)};this.SubscribeTSBEventInfo=function(a){f("MAPSubscribeEvent",{name:"TSBEventInfo"},a)};this.UnsubscribeTSBEventInfo=
function(a){f("MAPUnsubscribeEvent",{name:"TSBEventInfo"},a)};this.AdjustUserAgeRating=function(a,b){f("AdjustUserAgeRating",{tempAgeRating:a},b)};this.RevertUserAgeRating=function(a){f("RevertUserAgeRating",{},a)};this.GetDiagnostics=function(a){f("GetDiagnostics",{},a)};this.SendDiagMsg=function(a,b,c){k("SendTo","method","DiagResult","targetIP",b,"result",a,"message",c)};this.GetStandbyModeSettings=function(a){f("GetStandbyModeSettings",{},a)};this.SetStandbyModeSettings=function(a,b,c,e,d,m){f("SetStandbyModeSettings",
{autoStandby:a,timeout:b,startTime:c,endTime:e,weekday:d},m)};this.GetNetworks=function(a){a()};this.HideSplashScreen=function(){}};
pmrpc=self.pmrpc=function(){function d(){for(var a=[],b=0;36>b;b++)a[b]="0123456789ABCDEF"[Math.floor(16*Math.random())];a[14]="4";a[19]="89AB"[Math.floor(4*Math.random())];a[8]=a[13]=a[18]=a[23]="-";return a.join("")}function h(a,b){for(var c=a.whitelist,e=a.blacklist,n=!1,d=!1,f=0;f<c.length;++f)if(b.match(RegExp(c[f]))){n=!0;break}for(c=0;c<e.length;++c)if(b.match(RegExp(e[c]))){d=!0;break}return n&&!d}function k(a,b,c,e){if(!(c instanceof Array)){for(var n=a.toString(),d=n.substring(n.indexOf("(")+
1,n.indexOf(")")),d=""===d?[]:d.split(", "),n={},f=0;f<d.length;f++)n[d[f]]=f;var d=[],g;for(g in c)if("undefined"!==typeof n[g])d[n[g]]=c[g];else throw"No such param: "+g;c=d}"undefined"!==typeof e&&(c=c.concat(e));return a.apply(b,c)}function f(a,b,c){var e={jsonrpc:"2.0"};e.method=a;e.params=b;"undefined"!==typeof c&&(e.id=c);return e}function c(a,b,c){var e={};e.code=a;e.message=b;e.data=c;return e}function m(a,b,c){var e={jsonrpc:"2.0"};e.id=c;"undefined"===typeof a||null===a?e.result="undefined"===
b?null:b:e.error=a;return e}function e(a){if(a.publicProcedureName in t)return!1;u[a.publicProcedureName]={publicProcedureName:a.publicProcedureName,procedure:a.procedure,context:a.procedure.context,isAsync:"undefined"!==typeof a.isAsynchronous?a.isAsynchronous:!1,acl:"undefined"!==typeof a.acl?a.acl:{whitelist:["(.*)"],blacklist:[]}};return!0}function p(a){var c=a.event,e=a.source,n="undefined"!==typeof e&&null!==e;0===c.data.indexOf("pmrpc.")&&(a=JSON.parse(c.data.substring(6)),"undefined"!==typeof a.method?
(c={data:c.data,source:n?e:c.source,origin:n?"*":c.origin,shouldCheckACL:!n},a=q(a,c),null!==a&&b(c.source,a,c.origin)):r(a))}function q(a,e,n){if("2.0"!==a.jsonrpc)return m(c(-32600,"Invalid request.","The recived JSON is not a valid JSON-RPC 2.0 request."),null,null);var d=a.id;n=u[a.method];if("undefined"!==typeof n)if(!e.shouldCheckACL||h(n.acl,e.origin))try{if(n.isAsync)return k(n.procedure,n.context,a.params,[function(a){b(e.source,m(null,a,d),e.origin)},function(a){b(e.source,m(c(-1,"Application error.",
a.message),null,d),e.origin)},e]),null;var f=k(n.procedure,n.context,a.params,[e]);return"undefined"===typeof d?null:m(null,f,d)}catch(g){return"undefined"===typeof d?null:g.match("^(No such param)")?m(c(-32602,"Invalid params.",g.message),null,d):m(c(-1,"Application error.",g.message),null,d)}else return"undefined"===typeof d?null:m(c(-2,"Application error.","Access denied on server."),null,d);else return"undefined"===typeof d?null:m(c(-32601,"Method not found.","The requestd remote procedure does not exist or is not available."),
null,d)}function r(a){var c=a.id,b=n[c];if("undefined"!==typeof b&&null!==b)if(delete n[c],"undefined"===typeof a.error)b.onSuccess({destination:b.destination,publicProcedureName:b.publicProcedureName,params:b.params,status:"success",returnValue:a.result});else b.onError({destination:b.destination,publicProcedureName:b.publicProcedureName,params:b.params,status:"error",message:a.error.message+" "+a.error.data})}function a(a){if(a.retries&&0>a.retries)throw new Exception("number of retries must be 0 or higher");
var b=[];if("undefined"===typeof a.destination||null===a.destination||"workerParent"===a.destination)b=[{context:null,type:"workerParent"}];else if("publish"===a.destination)b=v().concat(w);else if(a.destination instanceof Array)for(var c=0;c<a.destination.length;c++)"workerParent"===a.destination[c]?b.push({context:null,type:"workerParent"}):"undefined"!==typeof a.destination[c].frames?b.push({context:a.destination[c],type:"window"}):b.push({context:a.destination[c],type:"worker"});else"undefined"!==
typeof a.destination.frames?b.push({context:a.destination,type:"window"}):b.push({context:a.destination,type:"worker"});for(c=0;c<b.length;c++){var e={destination:b[c].context,destinationDomain:"undefined"===typeof a.destinationDomain?["*"]:"string"===typeof a.destinationDomain?[a.destinationDomain]:a.destinationDomain,publicProcedureName:a.publicProcedureName,onSuccess:"undefined"!==typeof a.onSuccess?a.onSuccess:function(){},onError:"undefined"!==typeof a.onError?a.onError:function(){},retries:"undefined"!==
typeof a.retries?a.retries:5,timeout:"undefined"!==typeof a.timeout?a.timeout:500,status:"requestNotSent"};isNotification="undefined"===typeof a.onError&&"undefined"===typeof a.onSuccess;params="undefined"!==typeof a.params?a.params:[];callId=d();n[callId]=e;e.message=isNotification?f(a.publicProcedureName,params):f(a.publicProcedureName,params,callId);g(callId)}}function b(a,c,b){if("undefined"===typeof a||null===a)self.postMessage("pmrpc."+JSON.stringify(c));else{if("undefined"!==typeof a.frames)return a.postMessage("pmrpc."+
JSON.stringify(c),b);a.postMessage("pmrpc."+JSON.stringify(c))}}function g(e){var d=n[e];if("undefined"!==typeof d)if(-1>=d.retries)r(m(c(-4,"Application error.","Destination unavailable."),null,e));else if("requestSent"!==d.status)if(0===d.retries||"available"===d.status){d.status="requestSent";d.retries=-1;n[e]=d;for(var f=0;f<d.destinationDomain.length;f++)b(d.destination,d.message,d.destinationDomain[f],d),self.setTimeout(function(){g(e)},d.timeout)}else d.status="pinging",d.retries-=1,a({destination:d.destination,
publicProcedureName:"receivePingRequest",onSuccess:function(a){!0===a.returnValue&&"undefined"!==typeof n[e]&&(n[e].status="available",g(e))},params:[d.publicProcedureName],retries:0,destinationDomain:d.destinationDomain}),n[e]=d,self.setTimeout(function(){n[e]&&"pinging"===n[e].status&&g(e)},d.timeout/d.retries)}function s(a,c,b,e){"addEventListener"in a?a.addEventListener(c,b,e):a.attachEvent("on"+c,b)}function l(a,c,b){return function(e){a({event:e,source:c,destinationType:b})}}function v(){var a=
[];if("undefined"!==typeof window){a.push({context:window.top,type:"window"});for(var c=0;"undefined"!==typeof a[c];c++)for(var b=a[c],e=0;e<b.context.frames.length;e++)a.push({context:b.context.frames[e],type:"window"})}else a.push({context:this,type:"workerParent"});return a}if("undefined"===typeof JSON||"undefined"===typeof JSON.stringify||"undefined"===typeof JSON.parse)throw"pmrpc requires the JSON library";if("undefined"===typeof this.postMessage&&"undefined"===typeof this.onconnect)throw"pmrpc requires the HTML5 cross-document messaging and worker APIs";
var u={},n={},t={};if("window"in this){var x=l(p,null,"window");s(this,"message",x,!1)}else if("onmessage"in this)x=l(p,this,"worker"),s(this,"message",x,!1);else if("onconnect"in this)s(this,"connect",function(a){var c=l(p,a.ports[0],"sharedWorker");s(a.ports[0],"message",c,!1);a.ports[0].start()},!1);else throw"Pmrpc must be loaded within a browser window or web worker.";var y=this.Worker;this.nonPmrpcWorker=y;var z=this.SharedWorker;this.nonPmrpcSharedWorker=z;var w=[];this.Worker=function(a){a=
new y(a);w.push({context:a,type:"worker"});var c=l(p,a,"worker");s(a,"message",c,!1);return a};this.SharedWorker=function(a,c){var b=new z(a,c);w.push({context:b,type:"sharedWorker"});var e=l(p,b.port,"sharedWorker");s(b.port,"message",e,!1);b.postMessage=function(a,c){return b.port.postMessage(a,c)};b.port.start();return b};e({publicProcedureName:"receivePingRequest",procedure:function(a){return"undefined"!==typeof u[a]}});e({publicProcedureName:"getRegisteredProcedures",procedure:function(){var a=
[],c="undefined"!==typeof this.frames?window.location.protocol+"//"+window.location.host+(""!==window.location.port?":"+window.location.port:""):"",b;for(b in u)b in t||a.push({publicProcedureName:u[b].publicProcedureName,acl:u[b].acl,origin:c});return a}});t={getRegisteredProcedures:null,receivePingRequest:null};return{register:e,unregister:function(a){if(a in t)return!1;delete u[a];return!0},call:a,discover:function(a){var c=null;if("undefined"===typeof a.destination)for(var c=v().concat(w),b=0;b<
c.length;b++)c[b]=c[b].context;else c=a.destination;var e="undefined"===typeof a.originRegex?"(.*)":a.originRegex,d="undefined"===typeof a.nameRegex?"(.*)":a.nameRegex,n=c.length,f=[];pmrpc.call({destination:c,destinationDomain:"*",publicProcedureName:"getRegisteredProcedures",onSuccess:function(c){n--;var b=c.returnValue;c=c.destination;for(var g=0;g<b.length;g++)b[g].origin.match(RegExp(e))&&b[g].publicProcedureName.match(RegExp(d))&&f.push({publicProcedureName:b[g].publicProcedureName,destination:c,
procedureACL:b[g].acl,destinationOrigin:b[g].origin});0===n&&a.callback(f)},onError:function(c){n--;0===n&&a.callback(f)}})}}}();"function"==typeof define&&define.amd&&define(pmrpc);
WebApp.Controller=function(d){function h(a){g.debug("WebApp.Controller: received init reply");d.channels=a.returnValue[0];d.state.players=a.returnValue[1];d.state.applications=a.returnValue[2];d.initialized=!0;g.debug("WebApp.Controller: WebApp.model is initialized");e("model.initialized")}function k(a,c,b){var e=a[c][b];a=d.state.applications[c][b];e=e instanceof Object?JSON.stringify(e).substring(0,100):e;a=a instanceof Object?JSON.stringify(a).substring(0,100):a;return"model.state.applications."+
c+"."+b+" changed from "+e+" to "+a}function f(a,c,b){var e=a[c][b];a=d.state.players[c][b];e=e instanceof Object?JSON.stringify(e).substring(0,100):e;a=a instanceof Object?JSON.stringify(a).substring(0,100):a;return"model.state.players."+c+"."+b+" changed from "+e+" to "+a}function c(a,c){return!m(a,c)&&!!(null!==a&&void 0!==a||null!==c&&void 0!==c)}function m(a,c){if(a instanceof Function)return c instanceof Function?a.toString()===c.toString():!1;if(null===a||void 0===a||null===c||void 0===c)return a===
c;if(a===c||a.valueOf()===c.valueOf())return!0;if(a instanceof Date||c instanceof Date||!(a instanceof Object)||!(c instanceof Object))return!1;var b=Object.keys(a);return Object.keys(c).every(function(a){return-1!==b.indexOf(a)})?b.every(function(b){return m(a[b],c[b])}):!1}function e(a){g.debug("WebApp.Controller: notifyView('"+a+"')");try{b.emit(a,a)}catch(c){g.error("WebApp.Controller: error thrown by child webapp processing model event - "+c),c.stack&&g.error(c.stack)}}function p(a,c,b){void 0==
b&&(b=q);c.splice(0,0,window.name);g.debug("WebApp.Controller: sending pmrpc call to master controller - "+a+"("+JSON.stringify(c)+")");pmrpc.call({destination:window.top,publicProcedureName:a,params:[c],timeout:3E3,onSuccess:b,onError:r})}function q(a){g.trace("WebApp.Controller: pmrpc message ("+a.publicProcedureName+") delivery confirmed");void 0!=a.returnValue&&(g.debug("WebApp.Controller: object returned from pmrpc message send:  "+JSON.stringify(a.returnValue)),g.warn("WebApp.Controller: this return object is ignored"))}
function r(a){g.error("WebApp.Controller: pmrpc message "+a.publicProcedureName+"("+JSON.stringify(a.params)+") send FAILED");g.error("WebApp.Controller: error status info returned: "+a.message)}var a=this;d=d?d:new WebApp.Model;var b=new WebApp.EventEmitter({wildcard:!0}),g=new NAF.utils.Log,s;s=["model.channels","model.state.players","model.state.applications"];g.enable();0===NAF.conf.debug?g.setLevel.error():1===NAF.conf.debug?g.setLevel.warn():2===NAF.conf.debug?g.setLevel.debug():3===NAF.conf.debug?
g.setLevel.trace():4===NAF.conf.debug?g.setLevel.info():g.disable();this.on=function(a,c){b.on(a,c)};this.off=function(a,c){b.off(a,c)};this.init=function(){p("init",s,h)};this["do"]=function(c,b){if(c.match(/^model\.state\.applications\.\d+\.appMsg$/)&&b instanceof Object)if(void 0==b.sourceId){var e;try{e=a.getApplicationIndex(),b.sourceId=d.state.applications[e].id,g.debug("WebApp.Controller: supplying appMsg sourceId - "+b.sourceId+" for app #"+e)}catch(f){b.sourceId="unknown"}}else g.debug("WebApp.Controller: using webapp-supplied appMsg sourceId - "+
b.sourceId);b instanceof Object&&(b.serializedObjectType=b.constructor.name,g.debug("WebApp.Controller: serializing object type of do() argument and embedding type name - "+b.constructor.name));p("do",[c,b])};var l={},v=0;this.load=function(a,c){var b="load-callback-"+v++;l[b]=c;p("load",[a,b])};this.registerPMRPC=function(){pmrpc.register({publicProcedureName:"update-model",procedure:function(c){try{g.trace("WebApp.Controller: pmrpc model update message received - "+c),a.UpdateModel(c)}catch(b){g.error("WebApp.Controller: error thrown BY WEBAPP processing model update - "+
b),b.stack&&g.error(b.stack)}}});pmrpc.register({publicProcedureName:"load-callback",procedure:function(c){try{g.trace("WebApp.Controller: pmrpc load callback received - "+c),a.processLoadCallback(c)}catch(b){g.error("WebApp.Controller: error processing load callback - "+b),g.error(b.stack)}}})};this.UpdateModel=function(a){if("key"===a[0])g.debug("WebApp.Controller: key input received - "+JSON.stringify(a[1])),d.state.key=a[1],e("model.state.key");else if("application"==a[0]){var b=d.state.applications[a[1]].inFocus;
d.state.applications[a[1]].inFocus="true"==a[2];if(d.state.applications[a[1]].inFocus)if(b){for(var b=d.state.applications,m=parseInt(a[1]),p=0;p<b.length;p++)if(p!==m){var l=d.state.applications[p].inFocus;d.state.applications[p].inFocus=!1;l&&e("model.state.applications."+p)}g.debug("WebApp.Controller: focus set on app "+a[1]);e("model.state.applications."+a[1])}else g.trace("app "+a[1]+" already had focus");else g.trace("WebApp.Controller: focus unset on app "+a[1])}else if("channels"==a[0])g.debug("WebApp.Controller: channel array update received"),
d.channels=a[1];else if("applications"==a[0]){if(g.debug("WebApp.Controller: application array update received"),b=d.state.applications,d.state.applications=a[1],0!=b.length)for(a=0;a<b.length;a++)if(c(b[a].state,d.state.applications[a].state)&&(g.debug("WebApp.Controller: "+k(b,a,"state")+", notifying view"),e("model.state.applications."+a+".state")),c(b[a].appMsg,d.state.applications[a].appMsg)&&(g.debug("WebApp.Controller: "+k(b,a,"appMsg")+", notifying view"),e("model.state.applications."+a+".appMsg")),
void 0==b[a].media&&void 0!=d.state.applications[a].media){if(d.state.applications[a].media.assets&&0<d.state.applications[a].media.assets.length)for(g.debug("WebApp.Controller: app media data was created"),m=0;m<d.state.applications[a].media.assets.length;m++)e("model.state.applications."+a+".media.assets."+m)}else void 0!=b[a].media&&void 0==d.state.applications[a].media?g.debug("WebApp.Controller: app media data was either deleted"):c(b[a].media.assets,d.state.applications[a].media.assets)&&d.state.applications[a].media.assets.length>
b[a].media.assets.length&&(g.debug("WebApp.Controller: media asset list grew (from "+b[a].media.assets.length+" to "+d.state.applications[a].media.assets.length+"), notifying view"),e("model.state.applications."+a+".media.assets."+(d.state.applications[a].media.assets.length-1)))}else if("players"==a[0]){if(g.debug("WebApp.Controller: player array update received"),b=d.state.players,d.state.players=a[1],0!=b.length)for(a=0;a<b.length;a++)c(b[a].currentProgram,d.state.players[a].currentProgram)&&(g.debug("WebApp.Controller: "+
f(b,a,"currentProgram")+", notifying view"),e("model.state.players."+a+".currentProgram")),c(b[a].isBlocked,d.state.players[a].isBlocked)&&(g.debug("WebApp.Controller: "+f(b,a,"isBlocked")+", notifying view"),e("model.state.players."+a+".isBlocked")),c(b[a].playRate,d.state.players[a].playRate)&&(g.debug("WebApp.Controller: "+f(b,a,"playRate")+", notifying view"),e("model.state.players."+a+".playRate")),c(b[a].source,d.state.players[a].source)&&(g.debug("WebApp.Controller: "+f(b,a,"source")+", notifying view"),
e("model.state.players."+a+".source")),c(b[a].status,d.state.players[a].status)&&(g.debug("WebApp.Controller: "+f(b,a,"status")+", notifying view"),e("model.state.players."+a+".status")),c(b[a].position,d.state.players[a].position)&&(g.debug("WebApp.Controller: "+f(b,a,"position")+", notifying view"),e("model.state.players."+a+".position")),c(b[a].availAudioLangs,d.state.players[a].availAudioLangs)&&(g.debug("WebApp.Controller: "+f(b,a,"availAudioLangs")+", notifying view"),e("model.state.players."+
a+".availAudioLangs")),c(b[a].audioLang,d.state.players[a].audioLang)&&(g.debug("WebApp.Controller: "+f(b,a,"audioLang")+", notifying view"),e("model.state.players."+a+".audioLang")),c(b[a].availSubtitleLangs,d.state.players[a].availSubtitleLangs)&&(g.debug("WebApp.Controller: "+f(b,a,"availSubtitleLangs")+", notifying view"),e("model.state.players."+a+".availSubtitleLangs")),c(b[a].subtitleLang,d.state.players[a].subtitleLang)?(g.debug("WebApp.Controller: "+f(b,a,"subtitleLang")+", notifying view"),
e("model.state.players."+a+".subtitleLang")):c(b[a].subtitleLang.enable,d.state.players[a].subtitleLang.enable)&&(g.debug("WebApp.Controller: model.state.players."+a+".subtitleLang.enable changed from "+b[a].subtitleLang.enable+" to "+d.state.players[a].subtitleLang.enable+", notifying view"),e("model.state.players."+a+".subtitleLang.enable")),c(b[a].teletextLang,d.state.players[a].teletextLang)&&(g.debug("WebApp.Controller: "+f(b,a,"teletextLang")+", notifying view"),e("model.state.players."+a+".teletextLang")),
c(b[a].window,d.state.players[a].window)&&(g.debug("WebApp.Controller: "+f(b,a,"window")+", notifying view"),e("model.state.players."+a+".window"))}else"channelTuned"==a[0]&&(g.debug("WebApp.Controller: channel tuned update received - player "+a[1]+", channel "+a[2]),b=a[1],void 0!=a[2]&&(d.state.players[b].source.idx=a[2],e("model.state.players."+b+".source","model.state.players."+b+".source")))};this.processLoadCallback=function(a){var b=a[0];a=a[1];void 0===l[b]?g.error("could not identify callback with key "+
callback-key):(l[b].apply(this,[a]),delete l[b])};var u=null;this.getApplicationIndex=function(a){if(null!=u)return u;for(var b=0;b<d.state.applications.length;b++)if(window.name===d.state.applications[b].windowId)return u=b;if(void 0!=a)return a;g.error("WebApp.Controller: app index queried, but no app with window name "+window.name+" currently stored in model");throw Error("no app with window name "+window.name+" currently stored in model");}};
!function(d,h){function k(c,d,e,f){if(!e)return[];var q=[],h,a,b,g;b=d.length;g=d[f];var s=d[f+1];if(f===b&&e._listeners){if("function"===typeof e._listeners)c&&c.push(e._listeners);else for(d=0,f=e._listeners.length;d<f;d++)c&&c.push(e._listeners[d]);return[e]}if("*"===g||"**"===g||e[g]){if("*"===g){for(h in e)"_listeners"!==h&&e.hasOwnProperty(h)&&(q=q.concat(k(c,d,e[h],f+1)));return q}if("**"===g){(g=f+1===b||f+2===b&&"*"===s)&&e._listeners&&(q=q.concat(k(c,d,e,b)));for(h in e)"_listeners"!==h&&
e.hasOwnProperty(h)&&("*"===h||"**"===h?(e[h]._listeners&&!g&&(q=q.concat(k(c,d,e[h],b))),q=q.concat(k(c,d,e[h],f))):q=h===s?q.concat(k(c,d,e[h],f+2)):q.concat(k(c,d,e[h],f)));return q}q=q.concat(k(c,d,e[g],f+1))}(a=e["*"])&&k(c,d,a,f+1);if(e=e["**"])if(f<b)for(h in e._listeners&&k(c,d,e,b),e)"_listeners"!==h&&e.hasOwnProperty(h)&&(h===s?k(c,d,e[h],f+2):h===g?k(c,d,e[h],f+1):(b={},b[h]=e[h],k(c,d,{"**":b},f+1)));else e._listeners?k(c,d,e,b):e["*"]&&e["*"]._listeners&&k(c,d,e["*"],b);return q}var f=
Array.isArray?Array.isArray:function(c){return"[object Array]"===Object.prototype.toString.call(c)};WebApp.EventEmitter=function(c){this._events={};c&&(c.delimiter&&(this.delimiter=c.delimiter),c.wildcard&&(this.wildcard=c.wildcard),this.wildcard&&(this.listenerTree={}))};WebApp.EventEmitter.prototype.delimiter=".";WebApp.EventEmitter.prototype.setMaxListeners=function(c){this._events||(this._events={});this._events.maxListeners=c};WebApp.EventEmitter.prototype.event="";WebApp.EventEmitter.prototype.once=
function(c,d){this.many(c,1,d);return this};WebApp.EventEmitter.prototype.many=function(c,d,e){function f(){0===--d&&k.off(c,f);e.apply(this,arguments)}var k=this;if("function"!==typeof e)throw Error("many only accepts instances of Function");f._origin=e;this.on(c,f);return k};WebApp.EventEmitter.prototype.emit=function(){this._events||(this._events={});var c=arguments[0];if("newListener"===c&&!this._events.newListener)return!1;if(this._all){for(var d=arguments.length,e=Array(d-1),f=1;f<d;f++)e[f-
1]=arguments[f];f=0;for(d=this._all.length;f<d;f++)this.event=c,this._all[f].apply(this,e)}if("error"===c&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}var h;this.wildcard?(h=[],d="string"===typeof c?c.split(this.delimiter):c.slice(),k.call(this,h,d,this.listenerTree,0)):h=this._events[c];if("function"===typeof h){this.event=c;if(1===arguments.length)h.call(this);else if(1<
arguments.length)switch(arguments.length){case 2:h.call(this,arguments[1]);break;case 3:h.call(this,arguments[1],arguments[2]);break;default:d=arguments.length;e=Array(d-1);for(f=1;f<d;f++)e[f-1]=arguments[f];h.apply(this,e)}return!0}if(h){d=arguments.length;e=Array(d-1);for(f=1;f<d;f++)e[f-1]=arguments[f];h=h.slice();f=0;for(d=h.length;f<d;f++)this.event=c,h[f].apply(this,e);return 0<h.length||this._all}return this._all};WebApp.EventEmitter.prototype.on=function(c,d){if("function"===typeof c)return this.onAny(c),
this;if("function"!==typeof d)throw Error("on only accepts instances of Function");this._events||(this._events={});this.emit("newListener",c,d);if(this.wildcard){a:{for(var e=c,e="string"===typeof e?e.split(this.delimiter):e.slice(),h=0,k=e.length;h+1<k;h++)if("**"===e[h]&&"**"===e[h+1])break a;h=this.listenerTree;for(k=e.shift();k;){h[k]||(h[k]={});h=h[k];if(0===e.length){h._listeners?"function"===typeof h._listeners?h._listeners=[h._listeners,d]:f(h._listeners)&&(h._listeners.push(d),h._listeners.warned||
(e=10,"undefined"!==typeof this._events.maxListeners&&(e=this._events.maxListeners),0<e&&h._listeners.length>e&&(h._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",h._listeners.length),console.trace()))):h._listeners=d;break a}k=e.shift()}}return this}this._events[c]?"function"===typeof this._events[c]?this._events[c]=[this._events[c],d]:f(this._events[c])&&(this._events[c].push(d),
this._events[c].warned||(e=10,"undefined"!==typeof this._events.maxListeners&&(e=this._events.maxListeners),0<e&&this._events[c].length>e&&(this._events[c].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[c].length),console.trace()))):this._events[c]=d;return this};WebApp.EventEmitter.prototype.onAny=function(c){this._all||(this._all=[]);if("function"!==typeof c)throw Error("onAny only accepts instances of Function");
this._all.push(c);return this};WebApp.EventEmitter.prototype.addListener=WebApp.EventEmitter.prototype.on;WebApp.EventEmitter.prototype.off=function(c,d){if("function"!==typeof d)throw Error("removeListener only takes instances of Function");var e,h=[];if(this.wildcard)e="string"===typeof c?c.split(this.delimiter):c.slice(),h=k.call(this,null,e,this.listenerTree,0);else{if(!this._events[c])return this;e=this._events[c];h.push({_listeners:e})}for(var q=0;q<h.length;q++){var r=h[q];e=r._listeners;if(f(e)){for(var a=
-1,b=0,g=e.length;b<g;b++)if(e[b]===d||e[b].listener&&e[b].listener===d||e[b]._origin&&e[b]._origin===d){a=b;break}if(0>a)break;this.wildcard?r._listeners.splice(a,1):this._events[c].splice(a,1);0===e.length&&(this.wildcard?delete r._listeners:delete this._events[c])}else if(e===d||e.listener&&e.listener===d||e._origin&&e._origin===d)this.wildcard?delete r._listeners:delete this._events[c]}return this};WebApp.EventEmitter.prototype.offAny=function(c){var d=0,e=0,f;if(c&&this._all&&0<this._all.length)for(f=
this._all,d=0,e=f.length;d<e;d++){if(c===f[d]){f.splice(d,1);break}}else this._all=[];return this};WebApp.EventEmitter.prototype.removeListener=WebApp.EventEmitter.prototype.off;WebApp.EventEmitter.prototype.removeAllListeners=function(c){if(0===arguments.length)return this._events&&(this._events={}),this;if(this.wildcard)for(var d="string"===typeof c?c.split(this.delimiter):c.slice(),d=k.call(this,null,d,this.listenerTree,0),e=0;e<d.length;e++)d[e]._listeners=null;else{if(!this._events[c])return this;
this._events[c]=null}return this};WebApp.EventEmitter.prototype.listeners=function(c){if(this.wildcard){var d=[];c="string"===typeof c?c.split(this.delimiter):c.slice();k.call(this,d,c,this.listenerTree,0);return d}this._events||(this._events={});this._events[c]||(this._events[c]=[]);f(this._events[c])||(this._events[c]=[this._events[c]]);return this._events[c]};WebApp.EventEmitter.prototype.listenersAny=function(){return this._all?this._all:[]};"function"===typeof define&&define.amd?define(function(){return WebApp.EventEmitter}):
d.EventEmitter2=WebApp.EventEmitter}("undefined"!==typeof process&&"undefined"!==typeof process.title&&"undefined"!==typeof exports?exports:"undefined"!==typeof window?window:null);
WebApp.Model=function(){var d=function(d,c){this.code=d;this.type=c},h=function(){this.applications=[];this.key=null;this.players=[]},k=function(d,c,h){this.id=d;this.sourceId=c;this.method=h;this.message={}};this.State=h;this.Application=function(d,c,h,e,p,q,r,a,b,g,s,l){this.id=d;this.name=c;this.shortSynopsis=h;this.isAdult=e;this.isViewable=p;this.isEntitled=q;this.products=[];this.pictures=[];this.url=r;this.inFocus=a;this.windowId=b;this.viewState=g;this.state=s;this.type=l;this.appMsg=new k;
this.reservedKeys=[];this.appKeys=[];this.modelSets=[];this.media={assets:[]}};this.Player=function(f,c,h,e,k,q,r,a){this.currentChannel=this.source=f;this.playRate=c;this.position=h;this.window=e;this.zIndex=k;this.duration=q;this.status=null;this.availAudioLangs=[];this.availSubtitleLangs=[];this.audioLang=new d(r,a);this.subtitleLang=new d(r,a);this.teletextLang=new d(r,a);this.restricted=this.mapLoc=null;this.isBlocked=!1};this.channels=[];this.state=new h;this.Channel=function(d,c,h,e,k,q,r,
a){this.idx=d;this.id=c;this.locator=h;this.lcn=e;this.name=k;this.pictures=q;this.viewable=r;this.isFav=!1;this.plcn=0};this.keymap=new function(){this.VK_EXIT=3;this.VK_BACK_SPACE=8;this.VK_ENTER=this.VK_OK=13;this.VK_KEYBOARD=16;this.VK_ACCEPT=30;this.VK_SPACE=32;this.VK_PAGE_UP=33;this.VK_PAGE_DOWN=34;this.VK_HOME=36;this.VK_LEFT=37;this.VK_UP=38;this.VK_RIGHT=39;this.VK_DOWN=40;this.VK_0=48;this.VK_1=49;this.VK_2=50;this.VK_3=51;this.VK_4=52;this.VK_5=53;this.VK_6=54;this.VK_7=55;this.VK_8=56;
this.VK_9=57;this.VK_A=65;this.VK_B=66;this.VK_C=67;this.VK_D=68;this.VK_E=69;this.VK_F=70;this.VK_G=71;this.VK_H=72;this.VK_I=73;this.VK_J=74;this.VK_K=75;this.VK_L=76;this.VK_M=77;this.VK_N=78;this.VK_O=79;this.VK_P=80;this.VK_Q=81;this.VK_R=82;this.VK_S=83;this.VK_T=84;this.VK_U=85;this.VK_V=86;this.VK_W=87;this.VK_X=88;this.VK_Y=89;this.VK_Z=90;this.VK_RED=403;this.VK_GREEN=404;this.VK_BLUE=406;this.VK_YELLOW=405;this.VK_DELETE=127;this.VK_HELP=156;this.VK_POWER=409;this.VK_CHANNEL_UP=427;this.VK_CHANNEL_DOWN=
428;this.VK_VOLUME_UP=447;this.VK_VOLUME_DOWN=448;this.VK_MUTE=449;this.VK_INFO=457;this.VK_GUIDE=458;this.VK_BACK=461;this.VK_MENU=462;this.VK_PAUSE=19;this.VK_REW=412;this.VK_STOP=413;this.VK_PLAY=415;this.VK_REC=416;this.VK_FF=417;this.VK_REW_SKIP=424;this.VK_FWD_SKIP=425;this.VK_FAV=433;this.VK_TELETEXT=459;this.VK_SUBTITLE=460};this.MediaAsset=function(d,c,h,e,k,q,r,a,b,g,s,l,v){this.id=d;this.name=c;this.URL=h;this.picture=e;this.type=k;this.mimeType=q;this.encoding=r;this.description=a;this.genre=
b;this.date=g;this.size=s;this.duration=l;this.ageRating=v};this.AnnouncementEvent=function(d,c,h,e,k){this.type=d;this.time=c;this.message=h;this.imageURL=e;this.timeout=k};this.Announcement=function(d,c,h,e,k){this.event=d;this.id=c;this.name=h;this.image=e;this.url=k}};